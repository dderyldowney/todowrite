{
  "version": "1.0.0",
  "enforcement_permanent": true,
  "survives_session_reset": true,
  "last_updated": "2025-01-11T00:00:00Z",
  "agent_behavior_overrides": {
    "require_semantic_scoping": true,
    "require_red_green_refactor": true,
    "require_token_optimization": true,
    "require_todowrite_cli": true,
    "require_episodic_memory_search": true,
    "forbidden_practices": [
      "mocking_frameworks",
      "committing_without_tests",
      "ignoring_quality_gates",
      "bypassing_pre_commit_hooks"
    ]
  },
  "quality_gates": {
    "zero_tolerance_violations": [
      "semantic_scope_violations",
      "commit_message_format_errors",
      "security_vulnerabilities",
      "secret_detection",
      "syntax_errors",
      "mocking_framework_usage",
      "test_artifacts_remaining",
      "ruff_s_rule_violations",
      "bandit_security_failures",
      "real_implementation_violations",
      "hardcoded_tmp_files",
      "insecure_tempfile_usage",
      "alembic_violations",
      "python_version_mismatch",
      "invalid_python_requirements"
    ],
    "critical_checks": [
      "pre_commit_hooks_pass",
      "ruff_format_check",
      "ruff_security_mode_check",
      "bandit_security_check",
      "detect_secrets_scan",
      "semantic_scope_validation",
      "red_green_refactor_compliance",
      "zero_mocking_compliance",
      "test_artifact_cleanup",
      "real_implementation_only",
      "hardcoded_tmp_file_check",
      "secure_tempfile_usage",
      "alembic_migration_check",
      "python_version_compliance"
    ]
  },
  "mandatory_workflows": {
    "before_any_work": [
      "check_episodic_memory_for_context",
      "verify_semantic_scoping_understanding",
      "ensure_todowrite_cli_available"
    ],
    "for_any_code_change": [
      "write_failing_test_first",
      "implement_minimal_code",
      "refactor_while_tests_green"
    ],
    "before_any_commit": [
      "run_all_quality_checks",
      "validate_commit_message_format",
      "ensure_semantic_scope_correct"
    ]
  },
  "required_tools": {
    "always_active": [
      "semantic_scoping_validator",
      "red_green_refactor_enforcer",
      "token_optimizer",
      "ruff_linter_formatter",
      "bandit_security_scanner",
      "detect_secrets_scanner",
      "sqlfluff_linter"
    ],
    "pre_commit_enforced": [
      "conventional_commits",
      "check_builtin_literals",
      "check_executables_have_shebangs",
      "check_toml",
      "check_yaml",
      "debug_statements",
      "trailing_whitespace",
      "check_added_large_files"
    ]
  },
  "environment_overrides": {
    "CLAUDE_ENFORCE_SEMANTIC_SCOPING": "1",
    "CLAUDE_ENFORCE_RED_GREEN_REFACTOR": "1",
    "CLAUDE_ENFORCE_TOKEN_OPTIMIZATION": "1",
    "CLAUDE_ENFORCE_TODOWRITE_CLI": "1",
    "CLAUDE_ENFORCE_ZERO_MOCKING": "1",
    "CLAUDE_REQUIRE_EPISODIC_MEMORY": "1",
    "CLAUDE_MANDATORY_QUALITY_GATES": "1",
    "CLAUDE_PRE_COMMIT_ENFORCEMENT": "1",
    "CLAUDE_ENFORCE_RUFF_STRICT": "1",
    "CLAUDE_ENFORCE_BANDIT_SECURITY": "1",
    "CLAUDE_ENFORCE_SECURITY_MODE": "1",
    "CLAUDE_MANDATORY_REAL_IMPLEMENTATIONS": "1",
    "CLAUDE_ENFORCE_TEST_CLEANUP": "1",
    "CLAUDE_FORBID_TEST_ARTIFACTS": "1",
    "CLAUDE_FORBID_HARDCODED_TMP": "1",
    "CLAUDE_ENFORCE_SECURE_TEMPFILES": "1",
    "CLAUDE_ENFORCE_ALEMBIC": "1",
    "CLAUDE_ENFORCE_PYTHON_VERSION": "1",
    "CLAUDE_REQUIRE_PY312": "1",
    "CLAUDE_ABSOLUTE_ZERO_MOCKING": "1",
    "CLAUDE_REAL_IMPLEMENTATIONS_ONLY": "1",
    "CLAUDE_NO_FAKE_OBJECTS": "1",
    "CLAUDE_REQUIRE_TEMPFILE_MODULE": "1"
  },
  "verification_commands": {
    "check_enforcement_active": [
      "test -f .claude/permanent_code_quality_enforcement.json",
      "test -f .pre-commit-config.yaml",
      "test -f pyproject.toml"
    ],
    "validate_tools_available": [
      "which ruff",
      "which bandit",
      "python .hooks/token-optimizer.py --help",
      "python .hooks/semantic-scope-validator.py --help",
      "python .hooks/red-green-refactor-enforcer.py --help"
    ],
    "test_cleanup_verification": [
      "test ! -f tests_todowrite.db || echo 'ERROR: Test database artifact found'",
      "test ! -f commit-msgs.txt || echo 'ERROR: Commit message artifact found'",
      "find . -name '*.db' -not -path './.git/*' -not -path './.venv/*' -not -path './venv/*' | grep -v '__pycache__' && echo 'ERROR: Database files found'",
      "find . -name 'commit-msgs*.txt' -not -path './.git/*' && echo 'ERROR: Commit message files found'"
    ],
    "security_enforcement_verification": [
      "ruff check . --select=S",
      "bandit -r . -f json",
      "find . -name '*.py' -exec grep -l 'mock\\|Mock\\|patch\\|MagicMock' {} \\; | head -5 && echo 'ERROR: Mocking detected' || echo 'OK: No mocking found'"
    ],
    "tmp_file_enforcement_verification": [
      "python .hooks/tmp-file-enforcer.py --check",
      "find . -name '*.py' -not -path './.git/*' -not -path './.venv/*' -not -path './venv/*' -not -path './htmlcov/*' -exec grep -l '\\/tmp\\|\"tmp\"\\|\"temp\"\\|Path.*tmp\\|open.*tmp' {} \\; | head -3 && echo 'ERROR: Hardcoded tmp found' || echo 'OK: No hardcoded tmp'"
    ],
    "alembic_enforcement_verification": [
      "python .hooks/alembic-enforcer.py --check",
      "find . -name 'alembic.ini' -exec grep -l 'version_path_separator' {} \\; | head -1 && echo 'OK: Alembic config found' || echo 'WARNING: No alembic.ini found'"
    ],
    "python_version_enforcement_verification": [
      "grep -r 'target-version.*py312' *.toml | wc -l | grep -q '^3$' && echo 'OK: All packages target py312' || echo 'ERROR: Missing py312 target version'",
      "grep -r 'requires-python.*>=3\\.12' *.toml | wc -l | grep -q '^3$' && echo 'OK: All packages require >=3.12' || echo 'ERROR: Missing >=3.12 requirement'"
    ]
  }
}